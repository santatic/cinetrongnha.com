PageModuleCineManager.prototype=new Module;PageModuleCineManager.prototype.constructor=PageModuleCineManager;function PageModuleCineManager(b){Module.call(this,b);$.extend(this.setting,{header:!0})}
PageModuleCineManager.prototype.Init=function(b){Module.prototype.Init.call(this,b);var a=this;this.form.on("click",".view-more",function(b){var c=a.form.find(".posts .post");0<c.length&&a.Load({query:{skip:c.length}});b.preventDefault()});this.form.on("change",".tabmenu",function(b){b=$(this).find("option:selected").attr("md-tab");a.app._Router.Goto("+?tab="+b)});try{var c=/[\?|&]tab=(.*?)($|#|\?|&)/gi.exec(window.location.href)[1];a.form.find(".tabmenu:first>[md-tab="+c+"]").prop("selected",!0)}catch(d){}a.onRouter(function(b){b.post&&
(a.form.find(".post").removeClass("active"),a.form.find(".post[post-id="+b.post+"]").addClass("active"));if(b.param.tab){var c=a.form.find(".tabmenu:first>[md-tab="+b.param.tab+"]");1==c.length&&(console.debug(c,c.is(":selected")),c.is(":selected")||c.prop("selected",!0),a.form.find(".posts:first .post").remove(),a.Load(),a.form.find(".posts:first").attr("class","posts "+b.param.tab))}},{post:1,param:1});a.modal=$('<div class="modal fade" role="dialog" aria-hidden="true" data-backdrop="static"><div class="dialog col-md-10 col-md-offset-1"><div class="modal-content"></div></div></div>').modal({show:!1}).appendTo(a.form);
a.modal_content=a.modal.find(".modal-content:first");a._onFinished();a._onPostPublic();a._onPostPrivate();a._onPostEdit();a._onGroupManager();a._onChannelManager();a._onPostTrash();a._onPostRestore();a._onPostDelete()};
PageModuleCineManager.prototype._onFinished=function(){var b=this;this.form.on("click",".post .manager .finished",function(a){b.ManagerPost($(this).parents(".post:first"),{is:"finished"});a.preventDefault();a.stopPropagation()});this.form.on("click",".post .manager .unfinished",function(a){b.ManagerPost($(this).parents(".post:first"),{is:"unfinished"});a.preventDefault();a.stopPropagation()})};
PageModuleCineManager.prototype._onPostPublic=function(){var b=this,a=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Public post</h4></div><div class="modal-body"><div class="input-group"><input type="datetime" class="timer form-control"><span class="input-group-btn"><button class="btn btn-default reset" type="button"><span class="glyphicon glyphicon-repeat"></span></button></span></div></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-primary post-public">Public</button></div>');this.form.on("click",
".post .manager .public",function(c){var d=$(this),g=(new Date).toLocaleString();a.find("input.timer").val(g);b._modal_object=d.parents(".post:first");b.modal_content.html(a);b.modal.modal("show");c.preventDefault();c.stopPropagation()});this.modal.on("click",".modal-footer .btn.post-public",function(a){a=$(this).parents(".modal:first").find(".timer:first").val();a=(new Date(a)).getTime();a-=(new Date).getTime();isNaN(a)||(b.modal.modal("hide"),b.ManagerPost(b._modal_object,{is:"public",timestep:a}))});
this.modal.on("click",".btn.reset",function(a){a=(new Date).toLocaleString();$(this).parents(".modal:first").find(".timer:first").val(a)})};PageModuleCineManager.prototype._onPostPrivate=function(){var b=this;this.form.on("click",".post .manager .private",function(a){b.ManagerPost($(this).parents(".post:first"),{is:"private"});a.preventDefault();a.stopPropagation()})};
PageModuleCineManager.prototype._onPostEdit=function(){var b=this;this._GenericChapHTML=function(a){var c="";$.each(a.server,function(a,g){c+=b._GenericServerHTML(g)});return'<div class="chap"><div class="name">'+a.name.trim()+'</div><div class="servers">'+c+"</div></div>"};this._GenericServerHTML=function(a){var c="";$.each(a.part,function(a,g){c+=b._GenericPartHTML(g)});return'<div class="server"><div class="name">'+a.name.trim()+'</div><div class="parts">'+c+"</div></div>"};this._GenericPartHTML=
function(a){a=$.extend({name:"unknown",link:"",source:[],cache:{}},a);var b=$('<div class="part" part-link="'+a.link+'" part-source="'+Base64.encode(JSON.stringify(a.source))+'" part-cache="'+Base64.encode(JSON.stringify(a.cache))+'" ><div class="name">'+a.name.trim()+"</div></div>");if(void 0==a.link||""==a.link)console.debug("after",a.link),b.attr("part-link","").addClass("alert");return b[0].outerHTML};this.form.on("click",".post .manager .edit",function(a){var c=$(this).parents(".post:first"),
d={action:"edit",post:c.attr("post-id")};b.Load({query:d,callback:function(a){if(a.post){var d=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Edit Movie</h4></div><div class="modal-body"><ul class="nav nav-tabs" role="tablist"><li class="active"><a href="#movie-chaps" role="tab" data-toggle="tab">Chap</a></li><li><a href="#movie-info" role="tab" data-toggle="tab">Info</a></li><li><a href="#movie-append" role="tab" data-toggle="tab">Append MV</a></li><li><a href="#movie-json" role="tab" data-toggle="tab">JSON</a></li></ul><div class="tab-content movie-edit"><div class="tab-pane row active movie-chaps" id="movie-chaps"><div class="col-sm-12"><div class="menu"><div class="btn-group"><button type="button" title="Append" class="btn btn-group-sm btn-success btn-add"><span class="glyphicon glyphicon-plus"></span> Add</button><button type="button" title="Edit" class="btn btn-group-sm btn-primary btn-edit"><span class="glyphicon glyphicon-edit"></span> Edit</button><button type="button" title="Append" class="btn btn-group-sm btn-success btn-append"><span class="glyphicon glyphicon-plus"></span> Append</button></div><div class="btn-group"><button type="button" title="Move Up" class="btn btn-group-sm btn-info btn-up"><span class="glyphicon glyphicon-circle-arrow-up"></span></button><button type="button" title="Move Down" class="btn btn-group-sm btn-warning btn-down"><span class="glyphicon glyphicon-circle-arrow-down"></span> </button></div><div class="btn-group"><button type="button" title="Remove" class="btn btn-group-sm btn-danger btn-remove"><span class="glyphicon glyphicon-trash"></span></button></div></div><div class="inset chaps"></div></div><div class="col-sm-12"><div class="panel panel-default"><div class="panel-heading">Editor</div><div class="panel-body movie-editor"></div></div></div></div><div class="tab-pane row movie-info" id="movie-info"><div class="col-md-12"><div class="col-sm-6"><label>Poster</label><input type="text" name="poster" class="form-control"><label>Title</label><input type="text" name="title" class="form-control"><label>Sub Title</label><input type="text" name="subtitle" class="form-control"><label>Year</label><input type="number" name="year" class="form-control"><label>Length</label><input type="text" name="length" class="form-control"><label>Country</label><input type="text" name="country" class="form-control"><label>IMDb</label><input type="number" name="imdb" min="0" max="10" step="0.1" class="form-control"><label>Director</label><textarea class="form-control" name="director" rows="3"></textarea><label>Stars</label><textarea class="form-control" name="stars" rows="3"></textarea><label>Category</label><textarea class="form-control" name="category" rows="3"></textarea></div><div class="col-sm-6"><label>Trailer</label><textarea class="form-control" name="trailer" rows="3"></textarea><label>Image</label><textarea class="form-control" name="image" rows="3"></textarea><label>Source</label><textarea class="form-control" name="source" rows="3"></textarea><label>Description</label><textarea class="form-control" name="description" rows="15"></textarea></div></div></div><div class="tab-pane row movie-append" id="movie-append"><div class="col-md-12"><label>Movie Update/Append</label><textarea class="form-control" name="append-json" rows="18"></textarea><div class="col-md-8 col-md-offset-2"><div class="btn-group btn-group-justified"><div class="btn-group"><button type="button" class="btn btn-danger btn-block movie-append update"><b>UPDATE</b></button></div><div class="btn-group"><button type="button" class="btn btn-primary btn-block movie-append append"><b>APPEND</b></button></div></div></div></div></div><div class="tab-pane row movie-json" id="movie-json"><div class="col-md-12"><label>Movie JSON Update</label><textarea class="form-control" name="movie-json" rows="20"></textarea><div class="col-md-4 col-md-offset-4"><button type="button" class="btn btn-primary btn-block update"><b>UPDATE BACK</b></button></div></div></div></div></div><div class="modal-footer"><div class="btn-group btn-group-justified"><div class="btn-group"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div><div class="btn-group"><button type="button" class="btn btn-primary movie-edit">Edit</button></div></div></div>'),
f=d.find(".movie-edit");$.each(a.post,function(a,c){if("chap"==a){var d="";$.each(c,function(a,c){d+=b._GenericChapHTML(c)});f.find(".movie-chaps .chaps").html(d)}else{"array"==$.type(c)?c=c.join("\n"):"object"==$.type(c)&&(c=JSON.stringify(c));var g=f.find(".movie-info [name="+a+"]");g.is("input")?g.val(c):g.html(c)}});b._modal_object=c;b.modal_content.html(d);b.modal.modal("show")}}});a.preventDefault();a.stopPropagation()});this.modal.on("click",".movie-edit .movie-chaps .chaps .name",function(a){b.modal.find(".movie-edit .movie-chaps .chaps .active").removeClass("active");
$(this).parent().addClass("active");b.modal.find(".movie-edit .movie-editor").html("")});this.modal.on("click",".movie-edit .movie-chaps .menu .btn-edit",function(a){var c=b.modal.find(".movie-edit .movie-chaps .chaps .active");if(c.is(".part")){a=$('<div class="col-md-12"><label>Name</label><input type="text" name="name" class="form-control"><label>Link</label><div class="input-group"><input type="text" class="form-control" name="link"><span class="input-group-btn"><button type="button" class="btn btn-default get-cache"><span class="glyphicon glyphicon-cloud-download"></span> Update Cache</button></span></div><label>Cache</label><textarea class="form-control input-sm" name="cache" rows="10"></textarea><label>Source</label><div class="source-menu"><button type="button" class="btn btn-default get-link"><span class="glyphicon glyphicon-cloud-upload"></span> link</button></div><textarea class="form-control" name="source" rows="5"></textarea><div class="col-md-4 col-md-offset-4"><button type="button" class="btn btn-primary btn-block update"><b>UPDATE</b></button></div></div>');
var d=c.attr("part-link").trim(),g=$.parseJSON(Base64.decode(c.attr("part-source"))).join("\n"),e=js_beautify(Base64.decode(c.attr("part-cache")));a.find("input[name=link]").val(d);a.find("textarea[name=source]").val(g);a.find("textarea[name=cache]").val(e)}else a=$('<div class="col-md-12"><label>Name</label><input type="text" name="name" class="form-control"><div class="col-md-4 col-md-offset-4"><button type="button" class="btn btn-primary btn-block update"><b>UPDATE</b></button></div></div>');c=
c.children(".name").html().trim();a.find("input[name=name]").val(c);b.modal.find(".movie-edit .movie-editor").html(a).show()});this.modal.on("click",".movie-edit .movie-editor .btn.get-cache",function(a){a=b.modal.find(".movie-edit .movie-editor input[name=link]").val();$.getJSON(a,function(a){var d={video:[],expire:0};$.each(a.feed.media.content,function(a,b){0==b.type.indexOf("video")&&(d.video.push(b),d.expire||(d.expire=parseInt(b.url.split("expire=")[1].split("&"))))});b.modal.find(".movie-edit .movie-editor textarea[name=cache]").val(js_beautify(JSON.stringify(d)))})});
this.modal.on("click",".movie-edit .movie-chaps .movie-editor .get-link",function(a){a=b.modal.find(".movie-edit .movie-editor");var c=a.find("input[name=link]");(a=a.find("textarea[name=source]").val())&&$.each(a.split("\n"),function(a,b){if(b.search("picasaweb.google.com")){console.debug(b);var e=b.match(/[#|/][0-9]{15,25}/gi),f=b.match(/authkey=(.*?)[&|#|]/gi);console.debug(e);e&&2==e.length&&(e="https://picasaweb.google.com/data/feed/tiny/user"+e[0]+"/photoid/"+e[1].replace(/[#|/]/,"")+"?alt=jsonm",
f&&(e+="&authkey="+f[0].replace(/authkey\=|&|#/gi,"")),console.debug(e),c.val(e))}})});this.modal.on("click",".movie-edit .movie-chaps .movie-editor .update",function(a){a=b.modal.find(".movie-edit .movie-chaps .chaps .active");var c=b.modal.find(".movie-edit .movie-editor"),d=c.find("input[name=name]").val().trim();a.children(".name").html(d);a.is(".part")&&(d=c.find("input[name=link]").val().trim(),a.attr("part-link",d),void 0==d||""==d?a.addClass("alert"):a.removeClass("alert"),d=c.find("textarea[name=source]").val().trim(),
a.attr("part-source",Base64.encode(JSON.stringify(d.split("\n")))),d=c.find("textarea[name=cache]").val(),a.attr("part-cache",Base64.encode(JSON.stringify($.parseJSON(d)))));c.hide()});this.modal.on("click",".movie-edit .movie-chaps .menu .btn-add",function(a){a=b.modal.find(".movie-edit .movie-chaps .chaps .active");a.is(".chap")&&$('<div class="chap"><div class="name">Unknown</div><div class="servers"></div></div>').insertAfter(a)});this.modal.on("click",".movie-edit .movie-chaps .menu .btn-append",
function(a){a=b.modal.find(".movie-edit .movie-chaps .chaps .active");a.is(".chap")?$('<div class="server"><div class="name">Unknown</div><div class="parts"></div></div>').appendTo(a.find(".servers:first")):a.is(".server")?$('<div class="part" part-link="" part-source="W10=" part-cache="e30="><div class="name">Unknown</div></div>').appendTo(a.find(".parts:first")):a.is(".part")&&$('<div class="part" part-link="" part-source="W10=" part-cache="e30="><div class="name">Unknown</div></div>').insertAfter(a)});
this.modal.on("click",".movie-edit .movie-chaps .menu .btn-up",function(a){a=b.modal.find(".movie-edit .movie-chaps .chaps .active");var c=a.prev();0<c.length&&c.before(a.detach())});this.modal.on("click",".movie-edit .movie-chaps .menu .btn-down",function(a){a=b.modal.find(".movie-edit .movie-chaps .chaps .active");var c=a.next();0<c.length&&c.after(a.detach())});this.modal.on("click",".movie-edit .movie-chaps .menu .btn-remove",function(a){b.modal.find(".movie-edit .movie-chaps .chaps .active").remove()});
this.modal.on("change",".movie-edit .movie-append textarea[name=append-json]",function(a){$(this).val(js_beautify(JSON.stringify($.parseJSON($(this).val()))))});this.modal.on("click",".movie-edit .movie-append .btn.movie-append",function(a){var c=$(this);a=b.modal.find(".movie-edit .movie-append textarea[name=append-json]");var d=$.parseJSON(a.val()),g=!0;if(c.is(".update"))g=!1;else if(c.is(".append"))g=!0;else return;if(d.chap){var c=b.modal.find(".movie-edit .movie-chaps .chaps"),e;for(e in d.chap){var f=
d.chap[e],h=c.find(".chap>.name").filter(function(){return $(this).text()===f.name}).parent(".chap");if(0==h.length)h=b._GenericChapHTML(f),g?c.append(h):c.prepend(h);else if(f.server){var k=h.children(".servers");$.each(f.server,function(a,c){var d=b._GenericServerHTML(c);g?k.append(d):k.prepend(d)})}}}a.val("");b.modal.find(".nav-tabs a[href^='#movie-chaps']").click()});this.modal.on("change",".movie-edit .movie-json textarea[name=movie-json]",function(a){$(this).val(js_beautify(JSON.stringify($.parseJSON($(this).val()))))});
this.modal.on("click",".modal-footer .movie-edit",function(a){var c={};a=b.modal.find(".movie-edit .tab-pane:visible");if(a.is(".movie-chaps"))c.chap=[],$.each(a.find(".chap"),function(a,b){b=$(b);var e={name:b.children(".name").html().trim(),server:[]};$.each(b.find(".servers .server"),function(a,b){b=$(b);var c={name:b.children(".name").html().trim(),part:[]};$.each(b.find(".parts .part"),function(a,b){b=$(b);json_part={name:b.children(".name").html().trim(),source:$.parseJSON(Base64.decode(b.attr("part-source"))),
cache:$.parseJSON(Base64.decode(b.attr("part-cache"))),link:b.attr("part-link").trim()};json_part.cache.expire||delete json_part.cache;c.part.push(json_part)});e.server.push(c)});c.chap.push(e)});else if(a.is(".movie-info"))$.each(a.find("[name]"),function(a,b){b=$(b);var e=b.attr("name"),f=b.val();"length"==e&&(f=$.parseJSON(f));"description"!=e&&b.is("textarea")&&(tmp=f.split("\n"),f=[],$.each(tmp,function(a,b){b=b.trim();0<b.length&&f.push(b)}));c[e]=f});else if(a.is(".movie-json")){c=$.parseJSON(b.modal.find(".movie-edit .movie-json textarea[name=movie-json]").val());
b.ManagerPost(b._modal_object,{is:"edit",movie:c});b.modal.modal("hide");return}b.modal.find(".movie-edit .movie-json textarea[name=movie-json]").val(js_beautify(JSON.stringify(c)));b.modal.find(".nav-tabs a[href^='#movie-json']").click()})};
PageModuleCineManager.prototype._onGroupManager=function(){var b=this;this.form.on("click",".post .manager .groups",function(a){var c=$(this).parents(".post:first"),d=c.attr("post-id");b.Load({query:{action:"groupofpost",post:d},callback:function(a){if(a.post){var d=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Group Manager</h4></div><div class="modal-body groupmanager"><div class="row"><div class="col-sm-12"><label>Current Movie Group</label><div class="inset post-groups"></div></div><div class="col-sm-4"><label>T\u00ecm Group</label><div class="input-group"><input type="text" class="form-control find-group" placeholder="Find Group" autocomplete="off"><span class="input-group-btn"><button type="button" class="btn btn-default btn-find-group"><span class="glyphicon glyphicon-search"></span></button></span></div><label>Add Group</label><div class="input-group"><input type="text" class="form-control add-group" placeholder="Add Group" autocomplete="off"><span class="input-group-btn"><button type="button" class="btn btn-default btn-add-group"><span class="glyphicon glyphicon-plus"></span></button></span></div></div><div class="col-sm-4"><label>Groups</label><div class="groups inset"></div></div><div class="col-sm-4"><label>Movie in Group</label><div class="movies inset"></div></div></div></div><div class="modal-footer"><div class="btn-group btn-group-justified"><div class="btn-group"><button type="button" class="btn btn-danger group-remove" data-dismiss="modal">Leave</button></div><div class="btn-group"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div><div class="btn-group"><button type="button" class="btn btn-success group-join" data-dismiss="modal">Join</button></div></div></div>'),
f=d.find(".post-groups");$.each(a.post,function(a,c){var d=b._GenericGroupMovie(c);f.append(d)});b._modal_object=c;b.modal_content.html(d);b.modal.modal("show")}}});a.preventDefault();a.stopPropagation()});b.modal.on("click",".groupmanager .btn-find-group",function(a){a=b.modal_content.find(".groupmanager input.find-group").val().trim();b.Load({query:{action:"findgroup",g_name:a},callback:function(a){a.post&&(b.modal_content.find(".groupmanager .groups:first").html(""),$.each(a.post,function(a,c){b._AddGroupMovie({id:c.id,
name:c.name})}))}})});b.modal.on("click",".groupmanager .btn-add-group",function(a){a=b.modal_content.find(".groupmanager input.add-group").val().trim();3<a.length&&b._AddGroupMovie({name:a})});this._AddGroupMovie=function(a){b.__moviegroupscontainer=b.modal_content.find(".groupmanager .groups:first");a=b._GenericGroupMovie(a);b.__moviegroupscontainer.append(a);return a};this._GenericGroupMovie=function(a){a=$.extend({id:"",name:"Unknown"},a);return $('<div class="group row border-left"><div class="col-xs-12 content" group-id="'+
a.id+'">'+a.name+"</div></div>")};this.modal.on("click",".groupmanager .post-groups .group, .groupmanager .groups .group",function(a){b.modal.find(".groupmanager .post-groups .group.active, .groupmanager .groups .group.active").removeClass("active");(a=$(this).addClass("active").find(".content").attr("group-id"))&&1<a.length&&b.Load({query:{action:"postofgroup",g_id:a},callback:function(a){if(a.post){var d=b.modal_content.find(".groupmanager .movies").html("");$.each(a.post,function(a,b){var c=$('<div class="col-md-12 movie"><div class="col-xs-3 image"><img src="'+
b.poster+'"></div><div class="col-xs-9"><div class="title">'+b.title+"</div></div></div>");d.append(c)})}}})});this.modal.on("click",".modal-footer .btn.group-join",function(a){var c=b.modal.find(".groupmanager .groups .group.active:first .content");a=c.attr("group-id");var c=c.html(),d={is:"joingroup"};a&&3<a.length&&(d.g_id=a);c&&3<c.length&&(d.g_name=c);b.ManagerPost(b._modal_object,d)});this.modal.on("click",".modal-footer .btn.group-remove",function(a){var c=b.modal.find(".groupmanager .group.active:first .content");
a=c.attr("group-id");c.html();c={is:"leavegroup"};a&&3<a.length&&(c.g_id=a,b.ManagerPost(b._modal_object,c))})};
PageModuleCineManager.prototype._onChannelManager=function(){var b=this;this.form.on("click",".post .manager .channels",function(a){var c=$(this).parents(".post:first"),d=c.attr("post-id");b.Load({query:{action:"channelofpost",post:d},callback:function(a){if(a.post){var d=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Channel Manager</h4></div><div class="modal-body channelmanager"><div class="row"><div class="col-sm-12"><label>Current Movie channel</label><div class="inset post-channels"></div></div><div class="col-sm-4"><label>T\u00ecm channel</label><div class="input-group"><input type="text" class="form-control find-channel" placeholder="Find channel" autocomplete="off"><span class="input-group-btn"><button type="button" class="btn btn-default btn-find-channel"><span class="glyphicon glyphicon-search"></span></button></span></div></div><div class="col-sm-4"><label>channels</label><div class="channels inset"></div></div><div class="col-sm-4"><label>Movie in channel</label><div class="movies inset"></div></div></div></div><div class="modal-footer"><div class="btn-group btn-group-justified"><div class="btn-group"><button type="button" class="btn btn-danger channel-remove" data-dismiss="modal">Remove</button></div><div class="btn-group"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div><div class="btn-group"><button type="button" class="btn btn-success channel-join" data-dismiss="modal">Join</button></div></div></div>'),f=
d.find(".post-channels");$.each(a.post,function(a,c){var d=b._GenericChannelMovie(c);f.append(d)});b._modal_object=c;b.modal_content.html(d);b.modal.modal("show")}}});a.preventDefault();a.stopPropagation()});b.modal.on("click",".channelmanager .btn-find-channel",function(a){a=b.modal_content.find(".channelmanager input.find-channel").val().trim();b.Load({query:{action:"findchannel",c_name:a},callback:function(a){a.post&&(b.modal_content.find(".channelmanager .channels:first").html(""),$.each(a.post,
function(a,c){b._AddChannelMovie({id:c.id,name:c.name})}))}})});this._AddChannelMovie=function(a){b.__moviechannelscontainer=b.modal_content.find(".channelmanager .channels:first");a=b._GenericChannelMovie(a);b.__moviechannelscontainer.append(a);return a};this._GenericChannelMovie=function(a){a=$.extend({id:"",name:"Unknown"},a);return $('<div class="channel row border-left"><div class="col-xs-12 content" channel-id="'+a.id+'">'+a.name+"</div></div>")};this.modal.on("click",".channelmanager .post-channels .channel, .channelmanager .channels .channel",
function(a){b.modal.find(".channelmanager .post-channels .channel.active, .channelmanager .channels .channel.active").removeClass("active");$(this).addClass("active")});this.modal.on("click",".modal-footer .btn.channel-join",function(a){var c=b.modal.find(".channelmanager .channels .channel.active:first .content");a=c.attr("channel-id");c.html();c={is:"joinchannel"};a&&3<a.length&&(c.c_id=a,b.ManagerPost(b._modal_object,c))});this.modal.on("click",".modal-footer .btn.channel-remove",function(a){var c=
b.modal.find(".channelmanager .channel.active:first .content");a=c.attr("channel-id");c.html();c={is:"removechannel"};a&&3<a.length&&(c.c_id=a,b.ManagerPost(b._modal_object,c))})};
PageModuleCineManager.prototype._onPostTrash=function(){var b=this;this.form.on("click",".post .manager .trash",function(a){var c=$(this),d=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Trash Movie</h4></div><div class="modal-body">Move this post to trash ?</div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-danger post-trash" data-dismiss="modal">Trash</button></div>');b._modal_object=
c.parents(".post:first");b.modal_content.html(d);b.modal.modal("show");a.preventDefault();a.stopPropagation()});this.modal.on("click",".modal-footer .btn.post-trash",function(a){b.ManagerPost(b._modal_object,{is:"trash"})})};
PageModuleCineManager.prototype._onPostRestore=function(){var b=this;this.form.on("click",".post .manager .restore",function(a){var c=$(this),d=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Restore Movie</h4></div><div class="modal-body">Restore this post to private box?</div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-success post-restore" data-dismiss="modal">Restore</button></div>');b.modal_object_modal_object=
c.parents(".post:first");b.modal_content.html(d);b.modal.modal("show");a.preventDefault();a.stopPropagation()});this.modal.on("click",".modal-footer .btn.post-restore",function(a){b.ManagerPost(b._modal_object,{is:"restore"})})};
PageModuleCineManager.prototype._onPostDelete=function(){var b=this;this.form.on("click",".post .manager .delete",function(a){var c=$(this),d=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Delete Movie</h4></div><div class="modal-body">Delete this movie ?</div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-danger post-delete" data-dismiss="modal">Public</button></div>');b._modal_object=
c.parents(".post:first");b.modal_content.html(d);b.modal.modal("show");a.preventDefault();a.stopPropagation()});this.modal.on("click",".modal-footer .btn.post-delete",function(a){b.ManagerPost(b._modal_object,{is:"delete"})})};
PageModuleCineManager.prototype.ManagerPost=function(b,a){a.action="manager";a.module=this.form.attr("module-id");a.post=b.attr("post-id");console.debug(a);this.Load({query:a,callback:function(c){0==c.error&&("trash"==a.is||"restore"==a.is||"delete"==a.is?b.remove():"public"==a.is||"private"==a.is?b.removeClass("public private").addClass(a.is):"finished"!=a.is&&"unfinished"!=a.is||b.removeClass("finished unfinished").addClass(a.is))}})};
PageModuleCineManager.prototype.Refesh=function(){Module.prototype.Refesh.call(this);if("number"==typeof this.setting["max-height"]&&0<this.setting["max-height"]){var b=this.form.find(".main:first");b.data("md-heighted")||(b.css("max-height",this.setting["max-height"]+"vh"),b.data("md-heighted",!0))}};
