PageModuleCineSidebar.prototype=new Module;PageModuleCineSidebar.prototype.constructor=PageModuleCineSidebar;function PageModuleCineSidebar(b){Module.call(this,b)}
PageModuleCineSidebar.prototype.Init=function(b){Module.prototype.Init.call(this,b);var a=this;a.form.on("click",".btn.setting",function(){var c=$(this).parents(".post[post-id]:first").attr("post-id");a._MovieSetting(c)});a.form.on("swipeleft",".posts .post[post-id]",function(){var c=$(this).attr("post-id");a._MovieSetting(c)});a.modal=$('<div class="modal fade" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"></div></div></div>').modal({show:!1});a.modal.on("click",
".setting-send",function(){var c=a.modal.find("input[name=action]:checked").val(),b=a.modal.find("input[name=post-id]").val();a.app._Login.LoggedIn()?a.Load({query:{action:"setting",post:b,setting:c},processbar:!1,callback:function(c){1==c.success&&a.form.find(".post[post-id="+b+"]").remove()}}):(c=a.app._Store.get("mvlastview"))&&c[b]&&(delete c[b],a.app._Store.set("mvlastview",c),a.form.find(".post[post-id="+b+"]").remove())})};
PageModuleCineSidebar.prototype._MovieSetting=function(b){var a=$('<div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Setting</h4></div><div class="modal-body"><div class="alert alert-info" role="alert">Kh\u00f4ng qu\u00ean \u0111\u00e1nh gi\u00e1 b\u1ed9 phim b\u1eb1ng c\u00e1ch b\u1ea7u ch\u1ecdn rating ho\u1eb7c \u0111\u1ec3 l\u1ea1i nh\u1eefng b\u00ecnh lu\u1eadn hay, \u0111i\u1ec1u n\u00e0y gi\u00fap nhi\u1ec1u b\u1ea1n kh\u00e1c v\u00e0 ch\u00ednh b\u1ea1n t\u00ecm \u0111\u01b0\u1ee3c nh\u1eefng b\u1ed9 phim \u0111\u00e1ng xem m\u1ed9t c\u00e1ch d\u1ec3 d\u00e0ng h\u01a1n !</div><form class="form-horizontal" role="form"><input type="hidden" name="post-id" value=""><label class="radio-inline"><input type="radio" name="action" value="complete"> \u0110\u00e3 xem xong</label><label class="radio-inline"><input type="radio" name="action" value="remove"> X\u00f3a </label></form></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-primary setting-send" data-dismiss="modal">Xong</button></div>');a.find("input[name=post-id]").val(b);
this.modal.find(".modal-content").html(a);this.modal.modal("show")};
PageModuleCineSidebar.prototype.Refesh=function(){Module.prototype.Refesh.call(this);var b=this;if(!b.app._Login.LoggedIn()){var a=b.app._Store.get("mvlastview");a&&(a=Object.keys(a),b.Load({query:{post:a.join(",")},callback:function(a){a.post&&(a=b.Render("post",a.post),b.form.find(".posts .viewing").html(a))}}))}a=b.form.find("img.lazy");$.each(a,function(a,b){var d=$(b);d.data("lazyed")||($(b).lazyload({effect:"fadeIn"}),d.data("lazyed",!0))})};
